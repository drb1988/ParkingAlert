extends dashboard-layout-users
block content
      .row#users
        .col-lg-12
          .panel.panel-default
            .panel-body
              .dataTable_wrapper
                table.table.table-striped.table-bordered.table-hover#dataTables-content
                  thead
                    tr
                      th Name
                      th Nickname
                      th eMail
                      th City
                      th Banned
                  tbody
                    each user in users
                      tr
                        td #{user.first_name} #{user.last_name}
                        td
                          = user.nickname
                        td
                          = user.email
                        td
                          = user.user_city
                        td
                          -var redirect = user.is_banned ? 'Unban' : 'Ban'
                          -var btnclass = user.is_banned ? 'btn-warning' : 'btn-danger'
                          a(class='btn btn-xs '+btnclass href='javascript: ConfirmDialog("#{user._id}", "#{user.is_banned}")') 
                            = user.is_banned=='1' ? 'Ban' : 'Unban'

block scripts
  script(src='/js/jquery.min.js')
  script(src='https://code.jquery.com/ui/1.12.0-rc.2/jquery-ui.js')
  script(src='/js/datatables/jquery.dataTables.min.js' type="text/javascript")
  script.
    function ConfirmDialog(id, is_banned){
    console.log("aici: "+is_banned);
    if(is_banned)
      var answer = confirm('Are you sure that you want to unban this user?');
    else
      var answer = confirm('Are you sure that you want to ban this user?');
    if (answer)
    {
    console.log('yes');
    if(is_banned)
      document.location.href="/web-routes/users/unban/" + id;
    else
      document.location.href="/web-routes/users/ban/"+ id;
    }
    else
    {
    console.log('cancel');
    }
    };
  script.
    $(document).ready(function() {
    $('#dataTables-content').DataTable({
    responsive: true
    });
    });
 